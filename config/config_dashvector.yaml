# MineContext Configuration - DashVector Backend
# This configuration uses Aliyun DashVector for vector storage and MySQL for document storage

# Server configuration
server:
  host: "0.0.0.0"
  port: 1733
  debug: false
  api_key: "${MINECONTEXT_API_KEY}"  # API key for authentication (optional)

# User identity configuration
user:
  user_id: "${USER_ID:default_user}"
  device_id: "${DEVICE_ID:default_device}"
  agent_id: "${AGENT_ID:default_agent}"

# Storage configuration
storage:
  enabled: true
  backends:
    # DashVector vector database configuration
    - name: "default_vector"
      storage_type: "vector_db"
      backend: "dashvector"
      default: true
      config:
        api_key: "${DASHVECTOR_API_KEY}"
        endpoint: "${DASHVECTOR_ENDPOINT}"
        vector_size: 1536
        timeout: 30.0
        max_connections: 100           # 最大连接数
        max_connections_per_host: 20   # 每主机最大连接数

    # MySQL document database configuration
    - name: "default_document"
      storage_type: "document_db"
      backend: "mysql"
      default: true
      config:
        host: "${MYSQL_HOST:localhost}"
        port: ${MYSQL_PORT:3306}
        user: "${MYSQL_USER:root}"
        password: "${MYSQL_PASSWORD}"
        database: "${MYSQL_DATABASE:minecontext}"
        charset: "utf8mb4"

# Context capture configuration - disabled for service mode
context_capture:
  enabled: false  # Disable auto-capture, use push API instead
  components: []

# Context processing configuration
context_processing:
  enabled: true
  processors:
    - name: "screenshot"
      enabled: true
      config:
        similarity_threshold: 0.95
        max_batch_size: 10
        process_interval: 5

# LLM configuration
llm:
  provider: "openai"
  model: "${LLM_MODEL:gpt-4}"
  api_key: "${LLM_API_KEY}"
  base_url: "${LLM_BASE_URL:}"
  temperature: 0.7
  max_tokens: 4096

# Embedding configuration
embedding:
  provider: "openai"
  model: "${EMBEDDING_MODEL:text-embedding-3-small}"
  api_key: "${EMBEDDING_API_KEY:${LLM_API_KEY}}"
  base_url: "${EMBEDDING_BASE_URL:${LLM_BASE_URL}}"
  dimensions: 1536

# Redis cache configuration
redis:
  enabled: true
  host: "${REDIS_HOST:localhost}"
  port: ${REDIS_PORT:6379}
  password: "${REDIS_PASSWORD:}"
  db: ${REDIS_DB:0}
  key_prefix: "minecontext:"

# Logging configuration
logging:
  level: "INFO"
  format: "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan>:<cyan>{line}</cyan> - <level>{message}</level>"
  rotation: "10 MB"
  retention: "7 days"
